{"openapi":"3.1.0","info":{"title":"Bank Card Management API","description":"API for managing users and bank cards. Swagger UI available at: http://localhost:8080/swagger-ui/index.html","contact":{"name":"Karam","email":"karam.haffar.2002@hotmail.com"},"license":{"name":"Apache 2.0","url":"http://springdoc.org"},"version":"1.0"},"servers":[{"url":"http://localhost:8080","description":"Generated server url"}],"tags":[{"name":"API для управления банковскими картами","description":"Позволяет администратору создавать, получать, обновлять и удалять банковские карты"},{"name":"API для администратора","description":"Операции по управлению пользователями"},{"name":"API для пользователя","description":"Позволяет пользователю просматривать свои карты"},{"name":"getting Account API","description":"operations connected with user register/login"},{"name":"API для управления запросами на блокировку карт","description":"Админ может просматривать и обрабатывать запросы на блокировку карт"},{"name":"API для переводов между своими картами","description":"Позволяет пользователю переводить средства между своими картами"}],"paths":{"/api/v1/admin/users/{userId}/profile":{"put":{"tags":["API для администратора"],"summary":"Обновление профиля пользователя","description":"Позволяет обновить профиль пользователя по его UUID","operationId":"updateUserProfile","parameters":[{"name":"userId","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateUserProfileDTO"}}},"required":true},"responses":{"404":{"description":"Пользователь не найден","content":{"*/*":{"schema":{"type":"string"}}}},"200":{"description":"Профиль успешно обновлён","content":{"*/*":{"schema":{"type":"string"}}}},"400":{"description":"Некорректные данные запроса","content":{"*/*":{"schema":{"type":"string"}}}}}}},"/api/v1/admin/cards/{id}":{"put":{"tags":["API для управления банковскими картами"],"summary":"Обновить карту","description":"Администратор может изменить только статус и срок действия карты","operationId":"updateCard","parameters":[{"name":"id","in":"path","description":"UUID карты","required":true,"schema":{"type":"string"},"example":"d290f1ee-6c54-4b01-90e6-d701748f0851"}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CardUpdateDTO"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/CardResponseDTO"}}}}}}},"/api/v1/admin/block-requests/{requestId}":{"put":{"tags":["API для управления запросами на блокировку карт"],"summary":"Обработать запрос на блокировку карты","description":"Администратор может одобрить или отклонить запрос","operationId":"processBlockRequest","parameters":[{"name":"requestId","in":"path","required":true,"schema":{"type":"integer","format":"int64"}},{"name":"action","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string"}}}}}}},"/auth/client/register":{"post":{"tags":["getting Account API"],"summary":"Register a new player","description":"Creates a new player account. Requires unique email and username.","operationId":"registerPlayer","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserRegistrationDTO"}}},"required":true},"responses":{"409":{"description":"Email or username already exists"},"201":{"description":"Player registered successfully","content":{"*/*":{"schema":{"type":"string"}}}},"400":{"description":"Invalid input data"}}}},"/auth/client/login":{"post":{"tags":["getting Account API"],"summary":"User login","description":"Authenticates the player and returns a JWT token.","operationId":"login","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DTO for user login"}}},"required":true},"responses":{"200":{"description":"Login successful","content":{"application/json":{"schema":{"type":"string"},"example":{"token":"jwt-token-string"}}}},"401":{"description":"Unauthorized - Invalid credentials"}}}},"/auth/admin/login":{"post":{"tags":["getting Account API"],"summary":"User login","description":"Authenticates the player and returns a JWT token.","operationId":"login_1","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DTO for user login"}}},"required":true},"responses":{"200":{"description":"Login successful","content":{"application/json":{"schema":{"type":"string"},"example":{"token":"jwt-token-string"}}}},"401":{"description":"Unauthorized - Invalid credentials"}}}},"/api/v1/user/transfers":{"post":{"tags":["API для переводов между своими картами"],"summary":"Перевод между своими картами","description":"Позволяет перевести деньги между своими картами","operationId":"transfer","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TransferRequestDTO"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/TransferResponseDTO"}}}}}}},"/api/v1/admin/register":{"post":{"tags":["API для администратора"],"summary":"Регистрация нового пользователя","description":"Создаёт новую учетную запись пользователя. Требуется уникальный email и имя пользователя.","operationId":"registerPlayer_1","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserRegistrationDTO"}}},"required":true},"responses":{"409":{"description":"Email или имя пользователя уже существуют"},"400":{"description":"Некорректные входные данные"},"201":{"description":"Пользователь успешно зарегистрирован","content":{"*/*":{"schema":{"type":"string"}}}}}}},"/api/v1/admin/cards/{cardId}/block-request":{"post":{"tags":["API для управления банковскими картами"],"operationId":"requestCardBlock","parameters":[{"name":"cardId","in":"path","required":true,"schema":{"type":"string","format":"uuid"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string"}}}}}}},"/api/v1/admin/cards/create":{"post":{"tags":["API для управления банковскими картами"],"summary":"Создать новую карту","description":"Администратор может создать новую банковскую карту для конкретного пользователя","operationId":"createCard","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateCardDTO"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string"}}}}}}},"/auth/client/me/password":{"patch":{"tags":["getting Account API"],"summary":"Change the authenticated user's password","description":"This endpoint allows the authenticated user to change their password. The user needs to provide the current password and the new password. The current password will be validated before the password change operation proceeds.","operationId":"changePassword","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DTO for changing a player's password"}}},"required":true},"responses":{"400":{"description":"Bad request, e.g. invalid current password or weak new password","content":{"*/*":{"schema":{"type":"string"}}}},"401":{"description":"Unauthorized, user is not authenticated or password validation failed","content":{"*/*":{"schema":{"type":"string"}}}},"200":{"description":"Password changed successfully","content":{"*/*":{"schema":{"type":"string"}}}},"500":{"description":"Internal server error, unexpected issue","content":{"*/*":{"schema":{"type":"string"}}}}}}},"/auth/client/validate":{"get":{"tags":["getting Account API"],"operationId":"validateToken","parameters":[{"name":"token","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK"}}}},"/auth/admin/validate":{"get":{"tags":["getting Account API"],"operationId":"validateToken_1","parameters":[{"name":"token","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK"}}}},"/api/v1/user/transfers/me":{"get":{"tags":["API для переводов между своими картами"],"operationId":"getMyTransactions","parameters":[{"name":"pageable","in":"query","required":true,"schema":{"$ref":"#/components/schemas/Pageable"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/PageTransactionReturnDTO"}}}}}}},"/api/v1/user/cards":{"get":{"tags":["API для пользователя"],"summary":"Получить свои карты","description":"Возвращает список карт текущего авторизованного пользователя с поддержкой пагинации","operationId":"getUserCards","parameters":[{"name":"pageable","in":"query","description":"Параметры пагинации (page, size, sort)","required":true,"schema":{"$ref":"#/components/schemas/Pageable"},"example":"page=0&size=10&sort=expirationDate,desc"}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/PageCardResponseDTO"}}}}}}},"/api/v1/user/cards/search":{"get":{"tags":["API для пользователя"],"operationId":"searchCards","parameters":[{"name":"cardNumber","in":"query","required":true,"schema":{"type":"string"}},{"name":"pageable","in":"query","required":true,"schema":{"$ref":"#/components/schemas/Pageable"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/PageCardResponseDTO"}}}}}}},"/api/v1/admin/users":{"get":{"tags":["API для администратора"],"summary":"Получить всех пользователей с ролью USER","description":"Возвращает список всех пользователей, у которых роль USER","operationId":"getAllUsersWithRoleUser","responses":{"204":{"description":"Пользователи с ролью USER не найдены","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UserProfileDTO"}}}}},"200":{"description":"Список пользователей успешно возвращен","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UserProfileDTO"}}}}}}}},"/api/v1/admin/users/{id}":{"get":{"tags":["API для администратора"],"summary":"Получить пользователя по ID","description":"Возвращает информацию о пользователе по его UUID","operationId":"getUserById","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string","format":"uuid"}}],"responses":{"200":{"description":"Пользователь успешно найден и возвращен","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserProfileDTO"}}}},"404":{"description":"Пользователь с указанным ID не найден","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserProfileDTO"}}}}}},"delete":{"tags":["API для администратора"],"summary":"Удалить пользователя по ID","description":"Администратор может удалить пользователя по его UUID","operationId":"deleteUserById","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"404":{"description":"Пользователь не найден","content":{"*/*":{"schema":{"type":"string"}}}},"200":{"description":"Пользователь успешно удален","content":{"*/*":{"schema":{"type":"string"}}}},"403":{"description":"Доступ запрещен — требуется роль ADMIN","content":{"*/*":{"schema":{"type":"string"}}}}}}},"/api/v1/admin/clients/block-requests":{"get":{"tags":["API для администратора"],"operationId":"getAllRequests","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/CardBlockRequestDTO"}}}}}}}},"/api/v1/admin/cards":{"get":{"tags":["API для управления банковскими картами"],"summary":"Получить все карты","description":"Возвращает список всех карт вместе с основной информацией о владельцах","operationId":"getAllCards","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/CardResponseDTO"}}}}}}}},"/api/v1/admin/cards/{cardId}":{"get":{"tags":["API для управления банковскими картами"],"summary":"Получить карту по ID","description":"Возвращает информацию о карте по её уникальному идентификатору","operationId":"getCardByCardId","parameters":[{"name":"cardId","in":"path","description":"UUID карты","required":true,"schema":{"type":"string"},"example":"d290f1ee-6c54-4b01-90e6-d701748f0851"}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/CardResponseDTO"}}}}}},"delete":{"tags":["API для управления банковскими картами"],"summary":"Удалить карту","description":"Удаляет карту по её уникальному идентификатору","operationId":"deleteCard","parameters":[{"name":"cardId","in":"path","description":"UUID карты","required":true,"schema":{"type":"string"},"example":"d290f1ee-6c54-4b01-90e6-d701748f0851"}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string"}}}}}}},"/api/v1/admin/cards/transactions":{"get":{"tags":["API для управления банковскими картами"],"summary":"Получить все транзакции","description":"Администратор получает список транзакций с пагинацией","operationId":"getAllTransactions","parameters":[{"name":"pageable","in":"query","required":true,"schema":{"$ref":"#/components/schemas/Pageable"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/PageTransactionReturnDTO"}}}}}}},"/api/v1/admin/block-requests":{"get":{"tags":["API для управления запросами на блокировку карт"],"summary":"Получить все запросы на блокировку карт","description":"Администратор может просмотреть все запросы, фильтровать по статусу","operationId":"getAllBlockRequests","parameters":[{"name":"status","in":"query","required":false,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/CardBlockRequestDTO"}}}}}}}}},"components":{"schemas":{"UpdateUserProfileDTO":{"type":"object","description":"DTO для обновления профиля пользователя","properties":{"firstName":{"type":"string","description":"Имя пользователя","example":"Иван","maxLength":255,"minLength":3},"middleName":{"type":"string","description":"Отчество пользователя","example":"Иванович","maxLength":255,"minLength":3},"lastName":{"type":"string","description":"Фамилия пользователя","example":"Петров","maxLength":255,"minLength":3},"email":{"type":"string","description":"Email пользователя","example":"ivan.petrov@example.com"},"phoneNumber":{"type":"string","description":"Телефон пользователя","example":"+7 (999) 123-45-67","maxLength":18,"minLength":0,"pattern":"^\\+7\\s?\\(\\d{3}\\)\\s?\\d{3}[-\\s]?\\d{2}[-\\s]?\\d{2}$"},"birthDate":{"type":"string","format":"date","description":"Дата рождения пользователя","example":"1995-05-12"},"gender":{"type":"string","description":"Пол пользователя","example":"MALE"}}},"CardUpdateDTO":{"type":"object","description":"DTO для обновления карты администратором","properties":{"status":{"type":"string","description":"Новый статус карты","example":"BLOCKED"},"expirationDate":{"type":"string","format":"date","description":"Новый срок действия карты","example":"2028-12-31"}}},"CardResponseDTO":{"type":"object","description":"DTO для возврата информации о карте с ограниченной информацией о пользователе","properties":{"cardId":{"type":"string","format":"uuid"},"cardNumber":{"type":"string"},"expirationDate":{"type":"string","format":"date"},"balance":{"type":"number"},"status":{"type":"string"},"user":{"$ref":"#/components/schemas/UserShortDTOForCard"}}},"UserShortDTOForCard":{"type":"object","properties":{"userId":{"type":"string","format":"uuid"},"firstName":{"type":"string"},"lastName":{"type":"string"},"email":{"type":"string"},"phoneNumber":{"type":"string"},"birthDate":{"type":"string","format":"date"}}},"UserRegistrationDTO":{"type":"object","properties":{"firstName":{"type":"string","description":"Имя пользователя.","example":"Карам","maxLength":255,"minLength":3},"lastName":{"type":"string","description":"Фамилия пользователя.","example":"Карам","maxLength":255,"minLength":3},"password":{"type":"string","description":"User's password. Should be between 7 and 255 characters.","example":"pass123123","maxLength":255,"minLength":7},"email":{"type":"string","description":"Email пользователя. Должен быть уникальным.","example":"2002@hotmail.com"},"phoneNumber":{"type":"string","description":"Телефон пользователя. Формат: +7 (XXX) XXX-XX-XX.","example":"+7 (123) 333-22-11","pattern":"^\\+7\\s?\\(\\d{3}\\)\\s?\\d{3}[-\\s]?\\d{2}[-\\s]?\\d{2}$"},"birthDate":{"type":"string","format":"date","description":"Дата рождения пользователя. Формат: yyyy-MM-dd.","example":"2002-11-04"},"gender":{"type":"string","description":"Пол пользователя. Возможные значения: 'MALE', 'FEMALE'.","example":"MALE"}},"required":["email","firstName","lastName","password"]},"DTO for user login":{"type":"object","properties":{"email":{"type":"string","description":"user's email","example":"karam@example.com"},"password":{"type":"string","description":"user's password","example":"pass12345","maxLength":255,"minLength":7}},"required":["email","password"]},"TransferRequestDTO":{"type":"object","description":"Запрос на перевод средств между своими картами","properties":{"originCardId":{"type":"string","format":"uuid","description":"ID исходной карты","example":"d290f1ee-6c54-4b01-90e6-d701748f0851"},"destinationCardId":{"type":"string","format":"uuid","description":"ID карты получателя","example":"72bde859-d59e-4a61-b060-d5fa60426203"},"amount":{"type":"number","description":"Сумма перевода","example":500.0}}},"TransferResponseDTO":{"type":"object","description":"Ответ после выполнения перевода","properties":{"transactionId":{"type":"string","format":"uuid"},"originCardId":{"type":"string","format":"uuid"},"destinationCardId":{"type":"string","format":"uuid"},"amount":{"type":"number"},"createdAt":{"type":"string","format":"date-time"}}},"CreateCardDTO":{"type":"object","description":"DTO для создания банковской карты администратором","properties":{"userId":{"type":"string","format":"uuid","description":"Идентификатор пользователя, которому принадлежит карта","example":"d290f1ee-6c54-4b01-90e6-d701748f0851"},"cardNumber":{"type":"string","description":"Номер карты","example":"1234-5678-9012-3456","pattern":"\\d{4}-\\d{4}-\\d{4}-\\d{4}"},"expirationDate":{"type":"string","format":"date","description":"Срок действия карты","example":"2026-12-31"},"status":{"type":"string","description":"Статус карты","example":"ACTIVE"},"balance":{"type":"number","description":"Баланс карты","example":15000.5,"minimum":0.0}},"required":["balance","cardNumber","expirationDate","status","userId"]},"DTO for changing a player's password":{"type":"object","properties":{"currentPassword":{"type":"string","description":"The current password of the player","example":"oldPass123","maxLength":255,"minLength":7},"newPassword":{"type":"string","description":"The new password that the player wants to set","example":"newPass456","maxLength":255,"minLength":7},"passwordConfirmation":{"type":"string","description":"Confirmation of the new password to ensure they match","example":"newPass456","maxLength":255,"minLength":7}},"required":["currentPassword","newPassword","passwordConfirmation"]},"Pageable":{"type":"object","properties":{"page":{"type":"integer","format":"int32","minimum":0},"size":{"type":"integer","format":"int32","minimum":1},"sort":{"type":"array","items":{"type":"string"}}}},"PageTransactionReturnDTO":{"type":"object","properties":{"totalElements":{"type":"integer","format":"int64"},"totalPages":{"type":"integer","format":"int32"},"pageable":{"$ref":"#/components/schemas/PageableObject"},"first":{"type":"boolean"},"last":{"type":"boolean"},"size":{"type":"integer","format":"int32"},"content":{"type":"array","items":{"$ref":"#/components/schemas/TransactionReturnDTO"}},"number":{"type":"integer","format":"int32"},"sort":{"$ref":"#/components/schemas/SortObject"},"numberOfElements":{"type":"integer","format":"int32"},"empty":{"type":"boolean"}}},"PageableObject":{"type":"object","properties":{"paged":{"type":"boolean"},"pageNumber":{"type":"integer","format":"int32"},"pageSize":{"type":"integer","format":"int32"},"offset":{"type":"integer","format":"int64"},"sort":{"$ref":"#/components/schemas/SortObject"},"unpaged":{"type":"boolean"}}},"SortObject":{"type":"object","properties":{"sorted":{"type":"boolean"},"empty":{"type":"boolean"},"unsorted":{"type":"boolean"}}},"TransactionReturnDTO":{"type":"object","description":"DTO транзакции для администратора","properties":{"transactionId":{"type":"string","format":"uuid"},"amount":{"type":"number"},"createdAt":{"type":"string","format":"date-time"},"originCardNumber":{"type":"string"},"destinationCardNumber":{"type":"string"},"user":{"$ref":"#/components/schemas/UserShortDTOForCard"}}},"PageCardResponseDTO":{"type":"object","properties":{"totalElements":{"type":"integer","format":"int64"},"totalPages":{"type":"integer","format":"int32"},"pageable":{"$ref":"#/components/schemas/PageableObject"},"first":{"type":"boolean"},"last":{"type":"boolean"},"size":{"type":"integer","format":"int32"},"content":{"type":"array","items":{"$ref":"#/components/schemas/CardResponseDTO"}},"number":{"type":"integer","format":"int32"},"sort":{"$ref":"#/components/schemas/SortObject"},"numberOfElements":{"type":"integer","format":"int32"},"empty":{"type":"boolean"}}},"UserProfileDTO":{"type":"object","properties":{"userId":{"type":"string","format":"uuid"},"firstName":{"type":"string"},"middleName":{"type":"string"},"lastName":{"type":"string"},"email":{"type":"string"},"phoneNumber":{"type":"string"},"birthDate":{"type":"string","format":"date"},"gender":{"type":"string"}}},"CardBlockRequestDTO":{"type":"object","properties":{"requestId":{"type":"integer","format":"int64"},"card":{"$ref":"#/components/schemas/CardShortDTOForRequest"},"user":{"$ref":"#/components/schemas/UserShortDTOForRequest"},"status":{"type":"string"},"createdAt":{"type":"string","format":"date-time"},"processedAt":{"type":"string","format":"date-time"},"processedBy":{"$ref":"#/components/schemas/UserShortDTOForRequest"}}},"CardShortDTOForRequest":{"type":"object","properties":{"cardId":{"type":"string","format":"uuid"},"maskedCardNumber":{"type":"string"},"expirationDate":{"type":"string","format":"date"},"balance":{"type":"number"}}},"UserShortDTOForRequest":{"type":"object","properties":{"userId":{"type":"string","format":"uuid"},"firstName":{"type":"string"},"lastName":{"type":"string"}}}}}}